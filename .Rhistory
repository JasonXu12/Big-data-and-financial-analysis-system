shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
sparkR.stop()
sparkR.stop()
shiny::runApp()
source('/media/mickeylzj/CAFE/travail/foo/main.R')
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
sparkR.stop()
sparkR.stop()
sc <- SparkR::sparkR.init(master="local")
sqlContext <- SparkR::sparkRSQL.init(jsc = sc)
source('/media/mickeylzj/CAFE/travail/foo/main.R')
shiny::runApp()
sparkR.stop()
sparkR.stop()
sc <- SparkR::sparkR.init(master="local")
sqlContext <- SparkR::sparkRSQL.init(jsc = sc)
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
info=read.table(file,header = T,sep="\t",
encoding=encoding,
stringsAsFactors = F)
info %>% mutate(
LiRunLv_=ProfitLoss/Revenue,
ZiChanZhouZhuanLv_=Revenue/Assets,
QuanYiChengShu_=Assets/Equity)
hy_factor=factor(hy)
info=read.table(dupont,header = T,sep="\t"
encoding=encoding,
stringsAsFactors = F)
info=read.table(dupont,header = T,sep="\t",
encoding=encoding,
stringsAsFactors = F)
info=read.table(dupont.csv,header = T,sep="\t",
encoding=encoding,
stringsAsFactors = F)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
readDupont()
readDupont("data/dupont.csv")->ll
stringsAsFactors = F)
ll=readRDS("h:/ll.rds")
View(ll)
Encoding(ll$SuoShuZhengJianHuiHangYeDaLei)<-'UTF-8'
View(ll)
LiRunLv_=ProfitLoss/Revenue,
ZiChanZhouZhuanLv_=Revenue/Assets,
QuanYiChengShu_=Assets/Equity)
}
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
newll<-ll
newll
ll %>% filter(LiRunLv_<1&LiRunLv_>0)
ll %>% filter(LiRunLv_<1&LiRunLv_>0) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(mean=mean(LiRunLv_)) %>% ungroup()
ll %>% filter(LiRunLv_<1&LiRunLv_>0) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(mean=mean(LiRunLv_)) %>% ungroup() %>% arrange(asc(mean))
ll %>% filter(LiRunLv_<1&LiRunLv_>0) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(mean=mean(LiRunLv_)) %>% ungroup() %>% arrange(desc(mean))
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(mean=mean(ZiChanZhouZhuanLv_)) %>% ungroup() %>% arrange(asc(mean))
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(mean=mean(ZiChanZhouZhuanLv_)) %>% ungroup() %>% arrange(desc(mean))
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup() %>% arrange(desc(mean)) %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup() %>% arrange(desc(mean))
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup()
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup()  %>% VIew
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup()  %>% View()
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup()->res
qplot(meanZC,meanLR,data=res,color=SuoShuZhengJianHuiHangYeDaLei)
qplot(meanZC,meanLR,data=res,color=SuoShuZhengJianHuiHangYeDaLei,size=I(4))
qplot(meanZC,meanLR,data=res,color=SuoShuZhengJianHuiHangYeDaLei,size=I(4))+geom_text(aes(x=meanZC,y=meanLR,text=SuoShuZhengJianHuiHangYeDaLei))
qplot(meanZC,meanLR,data=res,color=SuoShuZhengJianHuiHangYeDaLei,size=I(4))+geom_text(aes(x=meanZC,y=meanLR,label=SuoShuZhengJianHuiHangYeDaLei))
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->res
ll
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=meanZC*meanQY*meanLR) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=meanZC*meanQY*meanLR) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
qplot(meanZC,meanLR,data=res,color=SuoShuZhengJianHuiHangYeDaLei,size=I(4))+geom_text(aes(x=meanZC,y=meanLR,label=SuoShuZhengJianHuiHangYeDaLei))
SuoShuZhengJianHuiHangYeDaLei
color
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup() %>% arrange(desc(mean)) %>% View
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5$(SuoShuZhengJianHuiHangYeDaLei=="教育")) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll$SuoShuZhengJianHuiHangYeDaLei
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei=="教育") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&(SuoShuZhengJianHuiHangYeDaLei=="教育"||SuoShuZhengJianHuiHangYeDaLei=="金融业")) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&(SuoShuZhengJianHuiHangYeDaLei=="教育"|SuoShuZhengJianHuiHangYeDaLei=="金融业")) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&(SuoShuZhengJianHuiHangYeDaLei=="教育"|SuoShuZhengJianHuiHangYeDaLei=="金融业"))  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(资产周转率=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_),meanROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(资产周转率=mean(ZiChanZhouZhuanLv_),利润率=mean(LiRunLv_),权益乘数=mean(QuanYiChengShu_),ROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(资产周转率=mean(ZiChanZhouZhuanLv_),利润率=mean(LiRunLv_),权益乘数=mean(QuanYiChengShu_),ROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(资产周转率=mean(ZiChanZhouZhuanLv_),利润率=mean(LiRunLv_),权益乘数=mean(QuanYiChengShu_),ROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% sll
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(资产周转率=mean(ZiChanZhouZhuanLv_),利润率=mean(LiRunLv_),权益乘数=mean(QuanYiChengShu_),ROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% dsc
scatterplot3d(资产周转率,利润率,权益乘数,data=res,color=SuoShuZhengJianHuiHangYeDaLei,size=I(4))+geom_text(aes(x=meanZC,y=meanLR,label=SuoShuZhengJianHuiHangYeDaLei))
res
scatterplot3d(meanZC,meanLR,meanQY,data=res,color=SuoShuZhengJianHuiHangYeDaLei,size=I(4))+geom_text(aes(x=meanZC,y=meanLR,label=SuoShuZhengJianHuiHangYeDaLei))
qplot(meanZC,meanLR,data=res,color=SuoShuZhengJianHuiHangYeDaLei,size=I(4))+geom_text(aes(x=meanZC,y=meanLR,label=SuoShuZhengJianHuiHangYeDaLei))
scatterplot3d(meanZC,meanLR,meanQY,data=res,color=SuoShuZhengJianHuiHangYeDaLei)
meanZC
res.meanZC
res$meanZC
scatterplot3d(res$meanZC,res$meanLR,RES$meanQY,data=res,color=SuoShuZhengJianHuiHangYeDaLei)
scatterplot3d(res$meanZC,res$meanLR,RES$meanQY,data=res,color=SuoShuZhengJianHuiHangYeDaLei)
scatterplot3d(res$meanZC,res$meanLR,res$meanQY,data=res,color=SuoShuZhengJianHuiHangYeDaLei)
scatterplot3d(res$meanZC,res$meanLR,res$meanQY,color=res$SuoShuZhengJianHuiHangYeDaLei)
scatterplot3d(res$meanZC,res$meanLR,res$meanQY)
color
library(rgl)
attach(res)
plot3d(meanZC,meanLR,meanQY,col = red,size = 5)
plot3d(meanZC,meanLR,meanQY,col = "red",size = 5)
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup()->res
res
res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup()->res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_)) %>% ungroup()->res
res.meanZC
ll=readRDS("ll.rds")
ll
Encoding(ll$SuoShuZhengJianHuiHangYeDaLei)<-'UTF-8'
source('C:/Users/xujx/Desktop/foo/dupont.R', encoding = 'UTF-8')
plotDupont(ll$LiRunLv_,ll$ZiChanZhouZhuanLv_,ll$QuanYiChengShu_,ll$SuoShuZhengJianHuiHangYeDaLei)
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&(SuoShuZhengJianHuiHangYeDaLei=="教育"|SuoShuZhengJianHuiHangYeDaLei=="金融业"))  %>% View
ll$Assets
ll$Assets %>% filter(ll$Assets!=NA) %>% lla
ll$Assets %>% filter(ll$Assets!="NA") %>% lla
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->res
res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>0&QuanYiChengShu_<5) %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->res
res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>0&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->res
res
scatterplot3d(x=res$meanZC,y=res$meanLR,z=res$meanQY,xlab="利润率",ylab="资产周转率",zlab="权益乘数_",color=color,pch=19 )
scatterplot3d(x=res$meanZC,y=res$meanLR,z=res$meanQY,xlab="利润率",ylab="资产周转率",zlab="权益乘数_",pch=19 )
allColors=c(RColorBrewer::brewer.pal(7,'Set1'),
RColorBrewer::brewer.pal(7,'Set2'),
RColorBrewer::brewer.pal(7,'Set3'))
scatterplot3d(x=res$meanZC,y=res$meanLR,z=res$meanQY,xlab="利润率",ylab="资产周转率",zlab="权益乘数_",color=allColors[1:19],pch=19 )
scatterplot3d(x=res$meanZC,y=res$meanLR,z=res$meanQY,xlab="利润率",ylab="资产周转率",zlab="权益乘数_",color=allColors[1:19],pch=19 )
scatterplot3d(x=res$meanZC,y=res$meanLR,z=res$meanQY,xlab="利润率",ylab="资产周转率",zlab="权益乘数_",color=,pch=19 )
scatterplot3d(x=res$meanZC,y=res$meanLR,z=res$meanQY,xlab="利润率",ylab="资产周转率",zlab="权益乘数_",color=allColors[1:19],pch=19 )
res
scatterplot3d(x=res$meanLR,y=res$meanZC,z=res$meanQY,xlab="利润率",ylab="资产周转率",zlab="权益乘数_",color=allColors[1:19],pch=19 )
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>0&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA"&SuoShuZhengJianHuiHangYeDaLei!="综合") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->res
res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>0&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA"&SuoShuZhengJianHuiHangYeDaLei!="综合") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(meanZC=mean(ZiChanZhouZhuanLv_),meanLR=mean(LiRunLv_),meanQY=mean(QuanYiChengShu_)) %>% ungroup()->View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(资产周转率=mean(ZiChanZhouZhuanLv_),利润率=mean(LiRunLv_),权益乘数=mean(QuanYiChengShu_),ROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5&SuoShuZhengJianHuiHangYeDaLei!="NA"&SuoShuZhengJianHuiHangYeDaLei!="综合") %>% group_by(SuoShuZhengJianHuiHangYeDaLei) %>% summarise(资产周转率=mean(ZiChanZhouZhuanLv_),利润率=mean(LiRunLv_),权益乘数=mean(QuanYiChengShu_),ROE=mean(LiRunLv_*QuanYiChengShu_*ZiChanZhouZhuanLv_)) %>% ungroup()  %>% View
attach(iris)
> SL<-iris$Sepal.Length
> SW<-iris$Sepal.Width
> PL <- iris$Petal.Length
> library(scatterplot3d)
> newiris<-iris
> newiris$Species<-NULL
> (kc<- kmeans(newiris,3))
attach(iris)
SL<-iris$Sepal.Length
SW<-iris$Sepal.Width
PL <- iris$Petal.Length
library(scatterplot3d)
newiris<-iris
newiris$Species<-NULL
(kc<- kmeans(newiris,3))
res
ll
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2) %>% res1
newll <- ll
newll$ProfitLoss<-NULL
newll$Assets<-NULL
newll$Equity<-NULL
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
newll
newll$Revenue<-NULL
newll
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>0&QuanYiChengShu_<5) %>% ->res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>0&QuanYiChengShu_<5) ->res
ll %>% filter(LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>0&QuanYiChengShu_<5) %>%res
newll<- na.omit(newll)
newll
dim(newll)
dim(ll)
copyll<-na.omit(ll)
names(ll)
dim(copyll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
newll<-na.omit(ll)
newll$Equity<-NULL
newll$Revenue<-NULL
newll$ProfitLoss<-NULL
newll$Assets<-NULL
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
newll
dim(newll)
dim(copyll)
table(copyll$SuoShuZhengJianHuiHangYeDaLei)
kc<-kmeans(newll,3)
newll[1:100]
newll[1:100,]
install.packages("sqldf")
library(sqldf)
install.packages("RSQLite")
install.packages("dplyr")
library(dplyr)
newll<-filter(newll,LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
dim(newll)
copyll<-filter(copyll,LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
kc<-kmeans(newll,3)
kc
cluster means
cluster::means
Cluster mean
Cluster means
kc$means
kc$cluster
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,color = kc$cluster)
newll<-filter(newll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
kc<-kmeans(newll,3)
kc<-kmeans(newll,3)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<1&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,color = kc$cluster)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,color = kc$cluster)
kc$centers
points(kc$centers[,c("LiRunLv_", "ZiChanZhouZhuanLv_","QuanYiChengShu_")], col = 1:3, pch = 8, cex=2)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,color = kc$cluster)
colors(1)
copyll$Equity<-NULL
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数"，color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,newll$LiRunLv_,zlab="利润率",xlab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,newll$LiRunLv_,zlab="利润率",xlab="资产周转率",ylab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$LiRunLv_,newll$QuanYiChengShu_,newll$ZiChanZhouZhuanLv_,xlab="利润率",zlab="资产周转率",ylab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,newll$LiRunLv_,zlab="利润率",xlab="资产周转率",zyab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$QuanYiChengShu_,newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,ylab="利润率",zlab="资产周转率",xlab="权益乘数",color = kc$cluster,pch=16)
kc$centers
scatterplot3d(kc$centers$LiRunLv_,kc$centers$ZiChanZhouZhuanLv_,kc$centers$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
dim(kc$centers)
kc$centers[1,]
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
table(copyll$SuoShuZhengJianHuiHangYeDaLei,kc$cluster)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16,size=10)
kc$centers
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,newll$LiRunLv_,zlab="利润率",xlab="资产周转率",ylab="权益乘数",color = kc$cluster,pch=16)
library(scatterplot3d)
scatterplot3d(newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,newll$LiRunLv_,zlab="利润率",xlab="资产周转率",ylab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,newll$LiRunLv_,zlab="利润率",xlab="资产周转率",ylab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
library(scatterplot3d)
newll
dim(newll)
kc<-kmeans(newll,3)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16,size=10)
kc
kc$centers
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16,xlim=(0,0.6))
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16,xlim=c(0,0.6))
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16,xlim=c(0,0.7),ylim=(0,2),zlim=(0,5))
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16,xlim=c(0,0.7),ylim=c(0,2),zlim=c(0,5))
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
copyll<-na.omit(ll)
copyll$ProfitLoss<-NULL
copyll$Assets<-NULL
copyll$Revenue<-NULL
copyll$Equity<-NULL
library(dplyr)
library(scatterplot3d)
copyll<-filter(copyll,LiRunLv_<0.6&LiRunLv_>0&ZiChanZhouZhuanLv_>0&ZiChanZhouZhuanLv_<2&QuanYiChengShu_>1&QuanYiChengShu_<5)
newll<-copyll
newll$SuoShuZhengJianHuiHangYeDaLei<-NULL
kc<-kmeans(newll,3)
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = kc$cluster,pch=16)
scatterplot3d(kc$centers[,1],kc$centers[,2],kc$centers[,3],xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = 1:3,pch=16,xlim=c(0,0.7),ylim=c(0,2),zlim=c(0,5))
kc$cluster
kc$size
kc$centers
scatterplot3d(newll$LiRunLv_,newll$ZiChanZhouZhuanLv_,newll$QuanYiChengShu_,xlab="利润率",ylab="资产周转率",zlab="权益乘数",color = "black",pch=16)
ll
